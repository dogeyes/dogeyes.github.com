---
layout: post
title: "风格"
description: ""
category: TPOP 
tags: [学习, TPOP]
---
{% include JB/setup %}

# 第1章 风格

程序不仅需要给计算机读， 也要给程序员读。

* 直截了当的逻辑
* 自然地表达方式 
* 通行的语言使用方式
* 有意义的名字
* 有帮助作用的注释
* 避免耍小聪明的花招
* 不使用非正规的结构

**一致性**

## 1.1 名字

* 非形式的
* 简练的
* 容易记忆
* 能够拼读

作用域越大名字携带的信息就应该越多

*全局变量使用具有说明性的名字,局部变量用短名字*

全局变量最好有个简短注释（全局函数，类，结构也都应该有说明性的名字）

并不是所有地方都需要使用长的变量名，清晰性经常是随着简洁而来的

保持**一致性**

相关的东西应该给以相关的名字

boolean型返回函数名字要标明返回的意义

要**准确**

名字不仅是个标记，还携带给读程序人的信息

## 1.2 表达式和语句

用**缩进**显示程序的结构，采用一致的缩进风格

使用表达式的**自然形式**，表达式应该能大声念出来。 否定运算要谨慎使用

用加**括号**的方式排除二义性

利用优先级比较复杂，还会有陷阱，还是多加括号

**分解**复杂的表达式，不要再一个表达式里面包含很多意思，即使这样写回较短

**要清晰**,目标是写出最清晰的代码,而不是最巧妙的代码.

谨慎的使用`?:`运算符, 适用于短的表达式

当心**副作用**, ++这类运算,还有I/O也有这种问题

    ?  scanf("%d %d", &yr, &profit[yr]);

因为是函数调用,传入函数的值是调用函数一瞬间的值,&profit[yr]不会因为读入yr而改变

## 1.3 一致性和习惯用法

**使用一致的缩排和加括号风格**

特定的风格远没有一致地使用它们重要

在修改别人的程序时要保留原来的风格

为了一致性,使用**习惯用法**

绝对不要使用函数gets

    ? char *p, buf[256];
    ? gets(buf);
    ? p = malloc(strlen(buf));   //strlen不计最后的'/0'
    ? strcpy(p, buf);            //strcpy计最后的'/0'

在实际程序中,调用malloc,realloc,strdup等牵涉到内存分配的函数,都要对返回值进行检测.

else-if表达多路选择

else垂直对齐,一系列嵌套的if通常是一段粗劣笨拙的代码

一个判断应该尽可能接近它所对应的动作

## 1.4 函数宏

**避免函数宏**, 现在已经没有意义了

一个参数被多次调用,这个参数有可能被多次求值, 若参数带有副作用,会产生难以捉摸的错误

**给宏的体和参数都加上括号**

## 1.5 神秘的数

1. 给神秘的数起个名字  
1. 把数定义为常数而不是定义为宏, C++中用const,Java中时final,C也有const但是不能用来做为数组边界,因此要使用enum
2. 使用字符常量而不是用整数,最好直接使用库函数,类似的还有0,用null来表示空指针,'\0'表示字符串结尾
3. 利用语言去计算对象的大小,不要直接用数字来表示类型的大小,sizeof(array[0])比sizeof(int)来的好,即使改变了数组类型也没什么关系

## 1.6 注释

简洁地点明程序的突出特性,或提供一种概观,帮助别人理解程序

**不要大谈明显的东西**

注释应该提供那些不能一下子从代码中看到的东西,或者把那些散布在许多代码里的信息收集到一起.

**给函数和全局数据加注释**

**不要注释差的代码,重写它**

应该注释所有不同寻常的或者可能迷惑人的内容,但是如果注释长度超过代码本身,可能说明代码应该修改了.

**不要与代码矛盾**

**澄清情况,不要添乱**

应该在需要的地方进行注释,注释不容易通过代码本身直接看到的意义.

## 1.7 为何对此费心

好的代码更容易阅读和理解,几乎可以保证其中错误更少

仔细推敲代码会更短小

养成写好风格代码的习惯.

