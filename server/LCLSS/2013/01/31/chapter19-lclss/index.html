<link href="/assets/themes/twitter/css/pygments.css" rel="stylesheet">

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>正则表达式 chapte19 LCLSS</title>
    <meta name="description" content="">
    <meta name="author" content="dogeyes">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">dogeyes</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>正则表达式 chapte19 LCLSS </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>31 January 2013</strong>
    </div>
    <div class="content">
      <h1>第19章 正则表达式</h1>

<h2>19.1 什么是正则表达式</h2>

<h3>19.1.1 定义</h3>

<p>过滤文本的模式模版</p>

<h3>19.1.2 正则表达式的类型</h3>

<p>难点在于不止一种类型的正则表达式</p>

<p><strong>正则表达式引擎(regular expression engine)</strong>,是解释正则表达式模式并使用这些模式进行文本匹配的底层软件</p>

<p>Linux中</p>

<ul>
<li>POSIX基本正则表达式(BRE)引擎</li>
<li>POSIX扩展正则表达式(ERE)引擎</li>
</ul>


<h2>19.2 定义BRE模式</h2>

<h3>19.2.1 纯文本</h3>

<p>直接用纯文本匹配,区分大小写,空格也可以匹配</p>

<h3>19.2.2 特殊字符</h3>

<pre><code>.*[]^${}\+?|()
</code></pre>

<p>这些都是特殊字符,不能在文本模式中单独使用</p>

<p><code>\</code>转义</p>

<p>尽管<code>/</code>不是特殊字符,但是</p>

<pre><code>echo "3 / 2" | sed -n '///p'
</code></pre>

<p>是错误的,<code>/</code>在此处也要转义</p>

<pre><code>echo "3 / 2" | sed -n '/\//p'
</code></pre>

<h3>19.2.3 锚字符</h3>

<h4>1. 锁定在行首</h4>

<p><code>^</code>脱字符(caret character),定义行首开始模式</p>

<p>如果<code>^</code>不在模式的第一位,那么会被当做普通字符(如果只用了脱字符,不需要转义;如果模式首位有脱字符,那么需要转义)</p>

<h4>2. 锁定在行尾</h4>

<p><code>$</code>美元符定义了行尾锚定点</p>

<pre><code> echo "This is a good book" | sed -n '\book$\p'
</code></pre>

<h4>3. 组合锚点</h4>

<pre><code>sed -n '/^this is a test$/p' data4

sed '\^$\d' data5  #删除空行
</code></pre>

<h3>19.2.4 点字符</h3>

<p><code>.</code>匹配任何单字符除了换行符,点字符必须匹配一个字符</p>

<h3>19.2.5 字符组</h3>

<p>字符组(character class), 使用<code>[]</code></p>

<pre><code>sed -n '/[ch]at/p' data6
</code></pre>

<h3>19.2.6 排除字符组</h3>

<p>在字符组开头加<strong>脱字符</strong></p>

<pre><code>sed -n '/[^ch]at/p' data6
</code></pre>

<h3>19.2.7 使用区间</h3>

<pre><code>sed -n '/^[0-9][0-9][0-9][0-9][0-9]&amp;/p' data5

sed -n '/[a-ch-m]at/p' data6 #多区间
</code></pre>

<h3>19.2.8 特殊字符组</h3>

<p>特殊字符组</p>

<table>
<thead>
<tr>
<th></th>
<th>组             </th>
<th>描述                          </th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>[[:alpha:]]   </td>
<td> 匹配任意字母字符,不管是大写还是小写|</td>
</tr>
<tr>
<td></td>
<td>[[:alnum:]]   </td>
<td> 匹配任意字母字符和数值           |</td>
</tr>
<tr>
<td></td>
<td>[[:blank:]]   </td>
<td> 匹配空格或制表符                |</td>
</tr>
<tr>
<td></td>
<td>[[:digit:]]   </td>
<td> 匹配数字                       |</td>
</tr>
<tr>
<td></td>
<td>[[:lower:]]   </td>
<td> 匹配小写字母                   |</td>
</tr>
<tr>
<td></td>
<td>[[:upper:]]   </td>
<td> 匹配大写字母                   |</td>
</tr>
<tr>
<td></td>
<td>[[:print:]]   </td>
<td> 匹配可打印字符                 |</td>
</tr>
<tr>
<td></td>
<td>[[:punct:]]   </td>
<td> 匹配标点符号                   |</td>
</tr>
<tr>
<td></td>
<td>[[:space:]]   </td>
<td> 匹配任意空白字符:空格,制表符,NL,FF,VT和CR|</td>
</tr>
</tbody>
</table>


<h3>19.2.9 星号</h3>

<p>放置在字符后面说明该字符会在匹配模式的文本中出现0次或多次</p>

<pre><code>echo 'ik' | sed -n '/ie*k/p'

echo "this is a regular pattern expression" | sed -n '
/regular.*expression/p'
</code></pre>

<p><code>.*</code> 结合表示任意多个任意字符</p>

<h2>19.3 扩展正则表达式</h2>

<p>POSIX ERE模式包括一些Linux应用和工具使用的若干额外符号,gawk能够识别ERE,但是sed不能</p>

<h3>19.3.1 问号</h3>

<p>问号表明前面的字符可以出现0次或1次</p>

<pre><code>echo "bt" | gawk '/be?t/{print $0}'
</code></pre>

<p>问号可以和字符组一起使用</p>

<h3>19.3.2 加号</h3>

<p>加号表明前面的字符可以出现1次或多次,至少出现一次</p>

<pre><code>echo "bet" | gawk '/be+t/{print $0}'
</code></pre>

<h3>19.3.3 使用花括号</h3>

<p>为可重复的正则表达式指定一个上限, 通常成为<strong>区间(interval)</strong></p>

<ul>
<li>m-----正则表达式准确出现m次</li>
<li>m, n -正则表达式至少出现m次,最多出现n次</li>
</ul>


<p>默认情况下.gawk不会识别正则表达式区间,必须为gawk程序指定--re-interval命令行选项来识别正则表达式区间</p>

<pre><code>echo "bt" | gawk --re-interval '/be{1}t/{print $0}'
</code></pre>

<h3>19.3.4 管道符号</h3>

<p>逻辑OR</p>

<pre><code>expr1|expr2|…

echo "The cat is asleep" | gawk '/cat|dog/{print $0}
</code></pre>

<h3>19.3.5 聚合表达式</h3>

<p>用圆括号聚合起来,该组会被当成一个特殊字符</p>

<pre><code>echo "Sat" | gawk '/Sat(urday)?/{print $0}'
</code></pre>

<h2>19.4 实用中的正则表达式</h2>

<h3>19.4.1 目录文件计数</h3>

<pre><code>mypath=`sed 's/:/ /g'`
count=0
for directory in $mypath
do
  check=`ls directory`
  for item in $check
  do
    count=$[ $count - 1 ]
  done
  echo "$directory - $count"
  count=0
done
</code></pre>

<h3>19.4.2 验证电话号码</h3>

<pre><code>^\(?[2-9][0-9]{2}\)?(| |-|\.)[0-9]{3}( |-|\.)[0-9]{4}$
</code></pre>

<h3>19.4.3 解析邮箱</h3>

<pre><code>username@hostname
</code></pre>

<p>username</p>

<ul>
<li>点号</li>
<li>单破折线</li>
<li>加号</li>
<li>下划线</li>
</ul>


<p>服务器名和域名</p>

<ul>
<li>点号</li>
<li>下划线</li>
</ul>


<p>解析邮箱的正则表达式</p>

<pre><code>^([a-zA-Z0-9_\-\.\+]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$
</code></pre>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#LCLSS-ref">
    		LCLSS <span>23</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#LCLSS-ref">LCLSS <span>23</span></a></li>
     
    	<li><a href="/tags.html#linux-ref">linux <span>23</span></a></li>
     
    	<li><a href="/tags.html#学习-ref">学习 <span>34</span></a></li>
     
    	<li><a href="/tags.html#command line-ref">command line <span>22</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/LCLSS/2013/01/30/chapter18-lclss" title="初识sed和gawk chapte18 LCLSS">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/LCLSS/2013/01/31/chapter20-lclss" title="sed进阶 chapter20 LCLSS">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>

      </div>
      <hr>
      <footer>
        <p>&copy; 2013 dogeyes
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

