<link href="/assets/themes/twitter/css/pygments.css" rel="stylesheet">

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>更多的结构化命令 chapte12 LCLSS</title>
    <meta name="description" content="">
    <meta name="author" content="dogeyes">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">dogeyes</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>更多的结构化命令 chapte12 LCLSS </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>06 January 2013</strong>
    </div>
    <div class="content">
      <h1>第12章 更多的结构化命令</h1>

<h2>12.1 for命令</h2>

<pre><code>for var in list
do
  commands
done
</code></pre>

<p>list参数指定了迭代中要用的一系列值,可以通过几种不同的途径来指定列表中的值.</p>

<p>var包含列表中的当前值,第一个迭代使用列表中的第一个值,第二个迭代用列表中的第二个值</p>

<pre><code>for var in list; do
</code></pre>

<h3>12.1.1 读取列表中的值</h3>

<p>直接列出来</p>

<pre><code>for test in A B C D E F
do
  echo $test
done
</code></pre>

<p>退出循环后test保持最终的值F,并且可以在后面的命令中使用</p>

<h3>12.1.2 读取列表中复杂的值</h3>

<p>列表中的值有<code>'</code>, <code>'</code>会被忽略,要用<code>"</code>来引用包含<code>'</code>的部分,或这用<code>\'</code>转义</p>

<p>列表中的值是按<strong>空格</strong>来分的,如果元素本身含有空格,那得到的结果不是我们想要的,用<code>"</code>或者<code>'</code>来将整个值包围</p>

<h3>12.1.3 从变量读取列表</h3>

<p>可以将一系列值都存储在一个变量中</p>

<pre><code>list="A B C D E F G"
list=$list" H"   拼接字符串的常用方法
for test in $list
do
  echo $test
done
</code></pre>

<h3>12.1.4 从命令读取</h3>

<p>还记得<code>`</code>可以用来引用任何命令输出的结果吗,这个结果也可以用在循环列表中</p>

<pre><code>for state in `cat $file`
do
  echo "Visit beautiful $state"
done
</code></pre>

<p>输出file变量中存储的文件中的内容,貌似是按单词分的而不是按行分的</p>

<h3>12.1.3 更改字段分隔符</h3>

<p>环境变量IFS, <strong>内部字段分割符(internal field separator)</strong>, IFS定义了bash shell用作字段分隔符的一系列字符</p>

<p>默认情况下使用<strong>空格</strong>,<strong>制表符</strong>,<strong>换行符</strong> 作为分割符</p>

<p>可以在shell脚本中临时换一下IFS</p>

<pre><code>IFS=$'\n'  不是直接 IFS='\n'这个不太搞得懂
</code></pre>

<p>一般可以先保存原来的IFS,用完后再赋值回来</p>

<pre><code>IFS.OLD=$IFS
IFS=$'\n'
&lt;use the new IFS value in code&gt;
IFS=$IFS.OLD
</code></pre>

<p><code>IFS=:</code>将IFS设定为<code>:</code></p>

<p><code>IFS=$'\n:;'"</code> 将换行符,冒号,分号,双引号设定为分隔符 仔细看看</p>

<h3>12.1.16 用通配符读取目录</h3>

<p>可以用for命令来自动遍历满是文件的目录,可以在文件名或路径名中使用通配符.它会强制shell使用文件扩展匹配(file globbing), 文件扩展匹配是生成匹配指定的通配符的文件名或路径名的过程</p>

<pre><code>for file in /home/dexctor/*
do
   if [ -d "$file" ]   这里要用双引号是因为$file可能有空格
   then
     echo "$file is a directory"
   elif [ -f "$file" ]
   then
     echo "$file is a file"
   fi
done
</code></pre>

<p>还可以将目录查找方法和列表方法合并进同一个for语句中</p>

<pre><code>for file in /home/rich/.b* /home/rich/badtest
....
</code></pre>

<h2>12.2 C语言风格的for命令</h2>

<pre><code>for (( a = 1; a &lt; 10; a++))
</code></pre>

<ul>
<li>给变量赋值可以用空格</li>
<li>条件中的变量不以<code>$</code>开头</li>
<li><p>算式不必用expr命令格式</p>

<p>  for (( i = 1; i &lt;= 10; i++))
  do
    echo "The next number is $i"
  done
  ehco "$i"</p></li>
</ul>


<p>i最后为11</p>

<h3>12.2.2 使用多个变量</h3>

<pre><code>for(( a = 1, b = 10; a &lt;= 10; a++, b--))
do
  echo "$a - $b"
done
</code></pre>

<h2>12.3 while命令</h2>

<h3>12.3.1 while的基本格式</h3>

<pre><code>while test command
do
  other command
done
</code></pre>

<p>while中定义的test命令和if-then定义的格式是一样的,和if-then语句中一样,你可以使用任何普通的bash shell命令,或者用test命令作为条件,比如变量值</p>

<p>while命令的关键是,指定的test命令的退出状态码必须随着循环中运行的命令改变,如果退出状态码不变,那while循环将会一直不停地循环</p>

<pre><code>var1=10
while [ $var1 -gt 0 ]
do
  echo $var1
  var1=$[ $var1 - 1 ]
done
</code></pre>

<h3>12.3.2 使用多个测试命令</h3>

<p>while命令允许在while语句行定义多个测试命令,只有最后一个测试命令的状态码会被用来决定什么时候结束循环</p>

<pre><code>var1=10
while echo $var1
      [ $var1 -ge 0 ]
do
    echo "this is in the loop"
    $var1=$[ $var1 - 1 ]
done
</code></pre>

<p>每个测试都在单独的一行上</p>

<h2>12.4 until命令</h2>

<p>until和while工作方式相反,until命令要求指定一个通常输出非零退出状态的测试命令,只有测试命令的退出状态码非零,bash shell才会指定循环中列出的那些命令,一旦测试命令返回退出状态码为0, 循环就结束了</p>

<pre><code>until test commands
do
   other commands
done
</code></pre>

<p>until亦可以有多个测试命令,由最后一个命令的退出状态码决定</p>

<h2>12.5 嵌套循环</h2>

<p><strong>嵌套循环(nested loop)</strong></p>

<pre><code>for(( a = 1; a &lt;= 3; ++a))
do
  echo "Starting loop $a:"
  for(( b = 1; b &lt;=3; ++b))
  do
    echo "   Inside loop: $b"
  done
done
</code></pre>

<h2>12.6 循环处理文件数据</h2>

<ul>
<li>使用嵌套循环</li>
<li>修改IFS环境变量</li>
</ul>


<p>如处理/etc/passwd文件中的数据,先用<code>'\n'</code>来划分,再用<code>':'</code>来划分,可以得到每一项</p>

<pre><code>IFS.OLD=$IFS
IFS=$'\n'
for entry in `cat /etc/passwd`
do
  echo "Values in $entry -"
  IFS=:
  for value in $entry
  do
    echo "  $value"
  done
done
</code></pre>

<h2>12.7 循环控制</h2>

<ul>
<li>break命令</li>
<li>continue命令</li>
</ul>


<h3>12.7.1 break命令</h3>

<h4>1. 跳出单个循环</h4>

<h4>2. 跳出内部循环</h4>

<h4>3. 跳出外部循环</h4>

<p><code>break n</code> 跳出n层循环,默认为1</p>

<h3>12.7.2 continue命令</h3>

<p><code>contine</code> 也可以使用多层, <code>continue n</code>定义了要继续的循环层级.</p>

<h2>12.8 处理循环的输出</h2>

<p>可以在<code>done</code>命令之后添加一个处理命令</p>

<pre><code>for file in /home/rich*
do
  if [ -d "$file" ]
  then
    ehco "$file is a directory"
  elif
    echo "$file is a file"
  fi
done &gt; output.txt
</code></pre>

<p>shell会将for命令的结果重定向到文件output.txt中.</p>

<p>还可以管接到另一个命令</p>

<p>'done | sort'</p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#LCLSS-ref">
    		LCLSS <span>23</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#LCLSS-ref">LCLSS <span>23</span></a></li>
     
    	<li><a href="/tags.html#linux-ref">linux <span>23</span></a></li>
     
    	<li><a href="/tags.html#学习-ref">学习 <span>34</span></a></li>
     
    	<li><a href="/tags.html#command line-ref">command line <span>22</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/git/2013/01/01/pro-git" title="pro git">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/TPOP/2013/01/17/algorithm-and-data-structure" title="算法与数据结构">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'jekyllbootstrap'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>

      </div>
      <hr>
      <footer>
        <p>&copy; 2013 dogeyes
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

